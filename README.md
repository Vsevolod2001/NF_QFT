# NF_QFT
В квантовой механике, квантовой теории поля и статистической физике широко применяется формализм функционального интеграла. 
В виде функционального интеграла можно выразить средние по распределению Гиббса от различных наблюдаемых. 
При достаточно малой температуре они приближённо равны среднему по основному состоянию. 
	
Однако, аналитически вычислить функциональный интеграл возможно лишь в некоторых точно решаемых моделях. 
В общем случае приходится использовать различные приближённые методы, например, вычисления на решётке. 
Функциональный интеграл аппроксимируется многократным интегралом большой ($2^4-2^{10}$) размерности. 
Многократные интегралы вычисляются далее с помощью метода Монте-Карло. 
Для этого необходимо генерировать многомерные векторы (траектории), имеющие заданное распределение.

В данном репозитории представлен нейросетевой алгоритм генерации (нормализующий поток) траекторий для вычисления функционального интеграла на решётке.

Генерируются многомерные векторы с плотностью распределения 
$$P(x)=\frac{\exp\left(-S(x)\right) }{Z}$$

Функция $S(x)$ есть евклидово действие, её вид зависит от конкретной задачи и определяется функцией гамильтона $H=T(p)+V(x)$. 
Например:
$$H=\frac{p^2}{2}+V(x) \qquad S=\sum_{i=1}^N \left[\frac{\left(x_{i+1}-x_i\right)^2}{2a}+aV(x_i)\right]$$
$$H=|p|+V(x) \qquad S=\sum_{i=1}^{N}\left[ \ln \left(1+\frac{\left(x_{i+1}-x_i\right)^2}{a^2}\right)+aV(x_i)\right]$$
$$H=\sqrt{p^2+1}+V(x)$$
$$S=\sum_{i=1}^N\left[\ln \left(y_iK_1\left(ay_i\right)\right)+aV(x_i) \right]   \qquad y_i=1+\frac{\left(x_{i+1}-x_i\right)^2}{a^2} $$
$K_1$-функция Макдональда
$$\mbox{осциллятор:} \qquad V(x)=\frac{x^2}{2}$$

более подробно см. https://link.springer.com/article/10.3103/S0027134924702096

Репозиторий организован следующим образом

Каталог 
systems - содержит все классы физических систем (физическая система фактически определяется видом кинетической и потенциальной энергий)

подкаталоги 
Nonrel - нерелятивистские системы
Rel - релятивистские
Ultrarel - ультрарелятивистские
все системы - наследники базового класса System 

Каталог 
flows - содержит класс нейросети theta.py, аффиный слой связи в Layers.py, класс нормализующиго потока Normalizingflow.py, многомасштабная архитектура - RGflows.py

Каталог 
samplers - содержит классы стандартных (без машинного обучения) Монте-Карло алгоритмов генерации траекторий

weights - веса обученных моделей
Schredinger - блокнот с примерами численного решения уравнения Шрёдингера

Data.py - класс данных (обёртка над случайными гауссовыми векторами)
Loss.py - класс loss-функции
transforms.py - вспомогательные преобразования и маски
obs.py - реализованы классы наблюдаемых (observables)
systems_initialization.py - заданы константы и инициализированы объекты наследников класса System 


